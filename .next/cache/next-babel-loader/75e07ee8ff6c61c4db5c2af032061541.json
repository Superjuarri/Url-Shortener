{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _JSON$stringify from \"@babel/runtime-corejs2/core-js/json/stringify\";\n\nvar webshot = require('webshot');\n\nvar fetchUrlData = function fetchUrlData(url) {\n  var urlData, screenshot;\n  return _regeneratorRuntime.async(function fetchUrlData$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          _context.next = 2;\n          return _regeneratorRuntime.awrap(fetch('https://rel.ink/api/links/', {\n            method: 'POST',\n            headers: {\n              'Content-Type': 'application/json'\n            },\n            body: _JSON$stringify({\n              url: url\n            })\n          }).then(function (res) {\n            return res.json();\n          })[\"catch\"](function (err) {\n            return err;\n          }));\n\n        case 2:\n          urlData = _context.sent;\n          _context.next = 5;\n          return _regeneratorRuntime.awrap(webshot(url, \"images/\".concat(urlData.hashid, \".png\"), function (err) {// screenshot now saved to google.png\n          }));\n\n        case 5:\n          screenshot = _context.sent;\n          return _context.abrupt(\"return\", {\n            urlData: urlData,\n            screenshot: screenshot\n          });\n\n        case 7:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  });\n};\n\nexport default fetchUrlData;","map":{"version":3,"sources":["/home/superjuarri/apps/url-shortener/lib/fetchUrlData.js"],"names":["webshot","require","fetchUrlData","url","fetch","method","headers","body","then","res","json","err","urlData","hashid","screenshot"],"mappings":";;;AAAA,IAAMA,OAAO,GAAGC,OAAO,CAAC,SAAD,CAAvB;;AAEA,IAAMC,YAAY,GAAG,SAAfA,YAAe,CAAMC,GAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2CACGC,KAAK,CAAC,4BAAD,EAA+B;AACxDC,YAAAA,MAAM,EAAE,MADgD;AAExDC,YAAAA,OAAO,EAAE;AACP,8BAAgB;AADT,aAF+C;AAKxDC,YAAAA,IAAI,EAAE,gBAAe;AACnBJ,cAAAA,GAAG,EAAEA;AADc,aAAf;AALkD,WAA/B,CAAL,CASnBK,IATmB,CASd,UAAAC,GAAG;AAAA,mBAAIA,GAAG,CAACC,IAAJ,EAAJ;AAAA,WATW,WAUb,UAAAC,GAAG;AAAA,mBAAIA,GAAJ;AAAA,WAVU,CADH;;AAAA;AACbC,UAAAA,OADa;AAAA;AAAA,2CAaMZ,OAAO,CAC9BG,GAD8B,mBAEpBS,OAAO,CAACC,MAFY,WAG9B,UAASF,GAAT,EAAc,CACZ;AACD,WAL6B,CAbb;;AAAA;AAabG,UAAAA,UAba;AAAA,2CAqBZ;AAAEF,YAAAA,OAAO,EAAPA,OAAF;AAAWE,YAAAA,UAAU,EAAVA;AAAX,WArBY;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAArB;;AAwBA,eAAeZ,YAAf","sourcesContent":["const webshot = require('webshot')\n\nconst fetchUrlData = async url => {\n  const urlData = await fetch('https://rel.ink/api/links/', {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({\n      url: url\n    })\n  })\n    .then(res => res.json())\n    .catch(err => err)\n\n  const screenshot = await webshot(\n    url,\n    `images/${urlData.hashid}.png`,\n    function(err) {\n      // screenshot now saved to google.png\n    }\n  )\n\n  return { urlData, screenshot }\n}\n\nexport default fetchUrlData\n"]},"metadata":{},"sourceType":"module"}